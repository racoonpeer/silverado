function CCheckout(){var e={form:null,wizard:null,container:null,construct:function(){var e=this;e.form=$("#orderForm"),e.container=$("#wizard")},initialize:function(){var e=this;e.construct(),e.setUpWizard(),e.setUpFields()},setUpWizard:function(){var e=this;e.wizard=e.container.steps({headerTag:"h3",bodyTag:"fieldset",transitionEffect:"slide",enablePagination:!0,enableFinishButton:!0,preloadContent:!0,stepsOrientation:$.fn.steps.stepsOrientation.vertical,onFinished:function(){e.form.submit()},onStepChanging:function(t,i,n){return i>n?!0:(n>i&&e.form.find(".error").removeClass("error"),e.form.validate().settings.ignore=":disabled,:hidden",e.form.valid())},labels:{cancel:"Отмена",current:"current step:",pagination:"Pagination",finish:"Оформить заказ",next:"Далее",previous:"Назад",loading:"Подождите ..."},onFinishing:function(){return e.form.validate().settings.ignore=":disabled,:hidden",e.form.valid()}}),$.validator.addMethod("ukrPhone",function(e,t){return this.optional(t)||/^\+38([0-9\s]{14})$/.test(e)},"Please enter a valid phone number"),e.form.validate({errorPlacement:function(e,t){t.addClass("error")},rules:{firstname:{required:!0},surname:{required:!0},phone:{required:!0,ukrPhone:!0},email:{required:!0,email:!0},city:{required:!0},address:{required:!0},ext_surname:{required:!0},ext_firstname:{required:!0}}})},setUpFields:function(){var e=this;e.form.find("#city").select2({placeholder:"Город",ajax:{url:window.location.href,dataType:"json",data:function(e){return{term:e.term,task:"getCities"}},processResults:function(e){return{results:e.items}}}}),e.form.find("#address").select2({placeholder:"Адрес",disabled:!0}),e.setUpAddress(),e.setUpRecepient(!0),e.form.find('input[name="phone"]').inputmask({mask:"+38 999 999 99 99",greedy:!1,definitions:{"*":{validator:"[0-9]",cardinality:1,casing:"lower"}}}),e.form.on("change blur keyup","input, textarea, select",function(){var t=$(this).attr("name"),i=($(this).attr("type"),$(this).val()),n=$(this).attr("id"),r=e.form.find('[data-source="'+t+'"]'),a=e.form.find('[data-toggle-id="'+n+'"]');$(this).closest("fieldset");r.length&&r.text(i),a.length&&(a.siblings("[data-toggle-id]").addClass("hidden"),a.removeClass("hidden")),"city"==t&&e.setUpAddress()})},setUpAddress:function(){var e=this,t=e.form.find("#city"),i=e.form.find("#address"),n=t.val();"undefined"!=typeof n&&$.ajax({url:window.location.href,dataType:"json",data:{term:n,task:"getAddress"},success:function(e){e.items&&e.items.length&&($.map(e.items,function(e){var t=new Option(e.text,e.text,!1,!1);i.append(t)}),i.prop("disabled",!1).trigger("change"))},beforeSend:function(){i.prop("disabled",!0).html("")}})},setUpRecepient:function(e){var t=this,i=t.form.find("#recepient"),n=i.closest(".f-row").next(".f-row"),r=n.find("input");i.is(":checked")?(r.prop("disabled",!1).addClass("required"),n.removeClass("hidden")):(r.prop("disabled",!0).removeClass("required"),n.addClass("hidden")),e=e||!1,e&&t.form.find("#recepient").on("change",function(){t.setUpRecepient()})}};this.init=function(){return e}}var objCheckout=new CCheckout,Checkout=objCheckout.init();$(function(){Checkout.initialize()});